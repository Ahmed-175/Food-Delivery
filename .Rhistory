shiny::runApp()
data <- read.csv("data/Food_Delivery_Times.csv")
data
View(data)
View(data)
View(data)
# library(dplyr)
# library(lubridate)
# library(stringr)
# clean_data <- function(
#   df,
#   late_threshold = 30,
#   max_distance_km = 200,
#   winsorize = TRUE,
#   verbose = TRUE
# ) {
#   log_msgs <- c()
#   add_log <- function(msg) {
#     log_msgs <<- c(log_msgs, paste(Sys.time, "-", msg))
#   }
#   add_log("start cleaning")
#   df <- as.data.frame(df)
#   add_log(sprintf("Initial rows: %d, cols: %d", nrow(df), ncol(df)))
#   names(df) <- (gsub("\\s+", "_", names(df)))
#   add_log("Normalized column names to lower_snake_case")
#   if (!"order_id" %in% names(df)) {
#     df$order_id <- as.character((seq_len((nrow(df)))))
#     add_log("order_id missing: created surrogate IDs")
#   } else {
#     df$order_id <- as.character((df$order_id))
#   }
#   numeric_cols <- c(
#     "Distance_km",
#     "Preparation_Time_min",
#     "Courier_Experience_yrs",
#     "Delivery_Time_min"
#   )
#   for (col in numeric_cols) {
#     if (col %in% names(df)) {
#       df[[col]] <- as.numeric(str_replace_all(as.character(df[[col]], ",", "")))
#       add_log(paste("Coerced to numeric:", col))
#     } else {
#       add_log(paste("Missing expected numeric column:", col))
#     }
#   }
#   if ("weather" %in% names(df)) {
#     df$weather <- as.character(df$weather)
#     df$weather <- str_trim(tolower(df$weather))
#     df$weather[df$weather %in% c("sunny", "clear", "sun")] <- "clear"
#     df$weather[df$weather %in% c("rain", "rainy", "raining")] <- "rain"
#     df$weather[df$weather == ""] <- NA
#     df$weather <- as.factor(df$weather)
#     add_log("Normalized weather categories")
#   }
#   if ("traffic_level" %in% names(df)) {
#     df$traffic_level <- as.character(df$traffic_level)
#     df$traffic_level <- str_trim(tolower(df$traffic_level))
#     df$traffic_level[df$traffic_level == ""] <- NA
#     df$traffic_level <- factor(df$traffic_level,
#       levels = c("low", "medium", "high"),
#       ordered = TRUE
#     )
#     add_log("Normalized traffic_level categories")
#   }
#   if ("vehicle_type" %in% names(df)) {
#     df$vehicle_type <- as.character(df$vehicle_type)
#     df$vehicle_type <- str_trim(tolower(df$vehicle_type))
#     df$vehicle_type[df$vehicle_type %in% c("bike", "bicycle", "cycle")] <- "bike"
#     df$vehicle_type[df$vehicle_type %in% c("motorbike", "motorcycle", "bike_motor")] <- "motorbike"
#     df$vehicle_type[df$vehicle_type %in% c("car", "car/van", "van")] <- "car"
#     df$vehicle_type[df$vehicle_type == ""] <- NA
#     df$vehicle_type <- as.factor(df$vehicle_type)
#     add_log("Normalized vehicle_type")
#   }
#   if ("time_of_day" %in% names(df)) { # Moring , Evening , Night , afternoon
#     df$vehicle_type <- as.character(df$vehicle_type)
#     df$vehicle_type <- str_trim(tolower(df$vehicle_type))
#     df$vehicle_type[df$vehicle_type %in% ""] <- NA
#     df$vehicle_type <- as.factor(df$vehicle_type)
#   }
#   if ("distance_km" %in% names(df)) {
#     bad_dist <- which(!is.na(df$distance_km) & (df$distance_km < 0 | df$distance_km > max_distance_km))
#     if (length(bad_dist) > 0) {
#       add_log(paste("Found", length(bad_dist), "distance_km values outside [0,", max_distance_km, "] - set to NA"))
#       df$distance_km[bad_dist] <- NA
#     }
#   }
# }
options(max.print = 1e6)
df<-read.csv("data/Food_Delivery_Times.csv")
df
#The frist step is identifying the duplicates rows
duplicated(df)
#Their number
sum(duplicated(df))
#The second step is Data structure
str(df)
summary(df)
#The third step is finding missing values(NA)
is.na(df)
#Their number
sum(is.na(df))
#Delet rows with missing values
df=na.omit(df)
df
#Delet empty boxes
df[df== ""]<-NA
df
colSums(is.na(df))
df=na.omit(df)
#Data type inspection and correction
is.integer(df$Order_ID)
df$Order_ID=as.integer(df$Order_ID)
is.integer(df$Order_ID)
is.character(df$Weather)
df$Weather=as.character(df$Weather)
is.character(df$Weather)
is.character(df$Traffic_Level)
df$Traffic_Level=as.character(df$Traffic_Level)
is.character(df$Traffic_Level)
is.character(df$Time_of_Day)
df$Time_of_Day=as.character(df$Time_of_Day)
is.character(df$Time_of_Day)
is.character(df$Vehicle_Type)
df$Vehicle_Type=as.character(df$Vehicle_Type)
is.character(df$Vehicle_Type)
is.numeric(df$Distance_km)
df$Distance_km=as.numeric(df$Distance_km)
is.numeric(df$Distance_km)
is.integer(df$Preparation_Time_min)
df$Order_ID=as.integer(df$Preparation_Time_min)
is.integer(df$Preparation_Time_min)
is.numeric(df$Courier_Experience_yrs)
df$Courier_Experience_yrs=as.numeric(df$Courier_Experience_yrs)
is.numeric(df$Courier_Experience_yrs)
is.integer(df$Delivery_Time_min)
df$Order_ID=as.integer(df$Delivery_Time_min)
is.integer(df$Delivery_Time_min)
#The fourth step is Handling outliers
outlier1=boxplot(df$Distance_km)
outlier1
outlier2=boxplot(df$Delivery_Time_min)
outlier2
outlier3=boxplot(df$Preparation_Time_min)
outlier3
outlier4=boxplot(df$Courier_Experience_yrs)
outlier4
#display outliers records
df[which(df$Order_ID%in%outlier1),]
df[which(df$Distance_km%in%outlier2),]
df[which(df$Courier_Experience_yrs%in%outlier3),]
#Remove outliers
dd=df[-which(df$Order_ID%in% outlier1),]
print(outlier1)
dd=df[-which(df$Distance_km%in% outlier2),]
print(outlier2)
dd=df[-which(df$Courier_Experience_yrs%in% outlier3),]
print(outlier3)
#The%in% operatorin R
A<-boxplot(df$Order_ID)
print(A)
B<-boxplot(df$Distance_km)
print(B)
C<-boxplot(df$Preparation_Time_min)
print(c)
D<-boxplot(df$Courier_Experience_yrs)
print(D)
E<-boxplot(df$Delivery_Time_min)
print(E)
#Finish the Data cleaning
str(dd)
summary(dd)
#Delet empty boxes
#df[df== ""]<-NA
#df
#colSums(is.na(df))
#df=na.omit(df)
#outlier
#summary(df$Delivery_Time_min)
#length(outlier)
#length(df$Delivery_Time_min)
#print(outlier)
View(dd)
View(df)
outlier1=boxplot(df$Distance_km)
outlier1
outlier2=boxplot(df$Delivery_Time_min)
outlier2
perform_kmeans <- function(df, k = 3, seed = 123) {
library(dplyr)
library(factoextra)
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
df_example <- data.frame(
Distance_km = c(2, 5, 1, 8, 3),
Preparation_Time_min = c(10, 20, 8, 30, 12),
Courier_Experience_yrs = c(1, 5, 0.5, 10, 2),
Speed_kmph = c(30, 50, 25, 60, 35)
)
result <- perform_kmeans(df_example, k = 2)
result$data
library(factoextra)
fviz_cluster(result$km, data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco")
source("/R/cleaning.R")
library(dplyr)
library(factoextra)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 5)
print(result$data)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco"
)
library(dplyr)
library(factoextra)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 2)
print(result$data)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco"
)
library(dplyr)
library(factoextra)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 4)
print(result$data)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco"
)
library(dplyr)
library(factoextra)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 5)
print(result$data)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco"
)
library(dplyr)
library(factoextra)
library(ggplot2)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 5)
print(head(result$data, 10))
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
n_orders = n()
)
print(cluster_summary)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco")
ggplot(result$data, aes(x = Distance_km, y = Preparation_Time_min, color = cluster)) +
geom_point(size = 3) +
labs(title = "Clusters of Food Delivery Orders",
x = "Distance (km)",
y = "Preparation Time (min)") +
theme_minimal()
fviz_nbclust(result$scaled, kmeans, method = "wss") +
labs(subtitle = "Elbow Method")
fviz_nbclust(result$scaled, kmeans, method = "silhouette") +
labs(subtitle = "Silhouette Method")
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco")
ggplot(result$data, aes(x = Distance_km, y = Preparation_Time_min, color = cluster)) +
geom_point(size = 3) +
labs(title = "Clusters of Food Delivery Orders",
x = "Distance (km)",
y = "Preparation Time (min)") +
theme_minimal()
fviz_nbclust(result$scaled, kmeans, method = "wss") +
labs(subtitle = "Elbow Method")
fviz_nbclust(result$scaled, kmeans, method = "silhouette") +
labs(subtitle = "Silhouette Method")
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
n_orders = n()
)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco")
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
n_orders = n()
)
print(cluster_summary)
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
ava_time_delivary = mean(Delivery_Time_min),
n_orders = n()
)
print(cluster_summary)
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
ava_time_delivary = mean(Delivery_Time_min),
n_orders = n()
)
print(cluster_summary)
View(outlier4)
library(dplyr)
library(factoextra)
library(ggplot2)
source("R/cleaning.R")
perform_kmeans <- function(df, k = 3, seed = 123) {
cluster_features <- df %>%
select(Distance_km, Preparation_Time_min, Courier_Experience_yrs, Speed_kmph)
cluster_scaled <- scale(cluster_features)
set.seed(seed)
km <- kmeans(cluster_scaled, centers = k, nstart = 25)
df$cluster <- factor(km$cluster)
return(list(data = df, km = km, scaled = cluster_scaled))
}
data <- read.csv("data/Food_Delivery_Times.csv")
df <- clean_data(data)
result <- perform_kmeans(df, k = 5)
print(head(result$data, 10))
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
ava_time_delivary = mean(Delivery_Time_min),
n_orders = n()
)
print(cluster_summary)
fviz_cluster(result$km,
data = result$scaled,
geom = "point",
ellipse.type = "norm",
palette = "jco")
ggplot(result$data, aes(x = Distance_km, y = Preparation_Time_min, color = cluster)) +
geom_point(size = 3) +
labs(title = "Clusters of Food Delivery Orders",
x = "Distance (km)",
y = "Preparation Time (min)") +
theme_minimal()
fviz_nbclust(result$scaled, kmeans, method = "wss") +
labs(subtitle = "Elbow Method")
fviz_nbclust(result$scaled, kmeans, method = "silhouette") +
labs(subtitle = "Silhouette Method")
cluster_summary <- result$data %>%
group_by(cluster) %>%
summarise(
avg_distance = mean(Distance_km),
avg_prep_time = mean(Preparation_Time_min),
avg_experience = mean(Courier_Experience_yrs),
avg_speed = mean(Speed_kmph),
ava_time_delivary = mean(Delivery_Time_min),
n_orders = n()
)
print(cluster_summary)
result$data %>%
group_by(cluster, Weather) %>%
summarise(count = n()) %>%
mutate(percentage = count / sum(count) * 100)
result$data %>%
group_by(cluster, Vehicle_Type) %>%
summarise(n = n()) %>%
mutate(perc = n / sum(n) * 100)
result$data %>%
group_by(cluster, Traffic_Level) %>%
summarise(n = n()) %>%
mutate(perc = n / sum(n) * 100)
df
#The second step is Data structure
str(df)
df<-read.csv("Food_Delivery_Times.csv")
#The second step is Data structure
str(df)
df<-read.csv("Food_Delivery_Times.csv")
df<-read.csv("Food_Delivery_Times.csv")
